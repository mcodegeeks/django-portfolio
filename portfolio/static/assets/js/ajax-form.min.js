function replaceDocument(docString){var doc=document.open("text/html");doc.write(docString),doc.close()}function doAjaxSubmit(e){var form=$(this),btn,method=($(this.clk).data("method")||form.data("method")||form.attr("method")||"GET").toUpperCase();if("GET"!==method){var contentType=form.find('input[data-override="content-type"]').val()||form.find('select[data-override="content-type"] option:selected').text();if("POST"!==method||contentType){e.preventDefault();var url=form.attr("action"),data;if(contentType){if(data=form.find('[data-override="content"]').val()||"","multipart/form-data"===contentType){var boundaryCharNoSpace="0-9A-Z'()+_,-./:=?",boundaryChar="0-9A-Z'()+_,-./:=? ",re=new RegExp("^--([0-9A-Z'()+_,-./:=? ]{0,69}[0-9A-Z'()+_,-./:=?])[\\s]*?$","im"),boundary=data.match(re);null!==boundary&&(contentType+='; boundary="'+boundary[1]+'"'),data=data.replace(/\n/g,"\r\n")}}else if("multipart/form-data"===(contentType=form.attr("enctype")||form.attr("encoding"))){if(!window.FormData)return void alert("Your browser does not support AJAX multipart form submissions");contentType=!1,data=new FormData(form[0])}else contentType="application/x-www-form-urlencoded; charset=UTF-8",data=form.serialize();var ret=$.ajax({url:url,method:method,data:data,contentType:contentType,processData:!1,headers:{Accept:"text/html; q=1.0, */*"}});return ret.always((function(data,textStatus,jqXHR){var responseContentType;if("success"!=textStatus&&(jqXHR=data),0===(jqXHR.getResponseHeader("content-type")||"").toLowerCase().indexOf("text/html")){replaceDocument(jqXHR.responseText);try{history.replaceState({},"",url),scroll(0,0)}catch(err){window.location=url}}else window.location=url})),ret}}}function captureSubmittingElement(e){var target=e.target,form=this;this.clk=target}$.fn.ajaxForm=function(){var options={};return this.unbind("submit.form-plugin  click.form-plugin").bind("submit.form-plugin",options,doAjaxSubmit).bind("click.form-plugin",options,captureSubmittingElement)};